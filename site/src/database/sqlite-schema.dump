-- || USER --
DROP TABLE IF EXISTS users;
CREATE TABLE users (
  id INTEGER PRIMARY KEY ASC,
  username TEXT UNIQUE NOT NULL,
  password TEXT NOT NULL
);

-- || BLOG --
DROP TABLE IF EXISTS blogs;
CREATE TABLE blogs (
  id INTEGER PRIMARY KEY ASC,
  date INTEGER NOT NULL DEFAULT (strftime('%s', CURRENT_TIMESTAMP)),
  title TEXT UNIQUE NOT NULL,
  intro TEXT,
  content TEXT NOT NULL,
  visible INTEGER NOT NULL DEFAULT 0
);

DROP INDEX IF EXISTS idx_blog_date;
CREATE INDEX idx_blog_date
ON blogs(date);

DROP TABLE IF EXISTS tags;
CREATE TABLE tags (
  id INTEGER PRIMARY KEY ASC,
  name TEXT UNIQUE NOT NULL
);

DROP TABLE IF EXISTS blog_tags;
CREATE TABLE blog_tags (
  blog_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  FOREIGN KEY(blog_id) REFERENCES blogs,
  FOREIGN KEY(tag_id) REFERENCES tags,
  PRIMARY KEY(blog_id, tag_id)
);

-- || PROJ --
DROP TABLE IF EXISTS projs;
CREATE TABLE projs (
  id INTEGER PRIMARY KEY ASC,
  title TEXT UNIQUE NOT NULL,
  description TEXT,
  url TEXT UNIQUE NOT NULL,
  img TEXT UNIQUE NOT NULL
);
